<%- include('includes/header', {username: admin[0].name, email: admin[0].email }) %>

<div class="body-wrapper">
    <div class="container-fluid">
        <!-- Header -->
        <div class="card bg-info-subtle shadow-none position-relative overflow-hidden mb-4">
            <div class="card-body px-4 py-3">
                <div class="row align-items-center">
                    <div class="col-md-8 col-sm-7">
                        <h4 class="fw-semibold mb-1">Manage Features</h4>
                    </div>
                    <div class="col-md-4 col-sm-5 text-md-end text-sm-start mt-3 mt-md-0">
                        <button id="addGrowToolBtn" class="btn btn-primary px-4">
                            <i class="fa-solid fa-plus me-2"></i> Add Features
                        </button>
                    </div>
                </div>
            </div>
        </div>
    <div class="card shadow-sm">
        <div class="card-body">

          <h4 class="mb-4">Update Features</h4>

          <form id="sectionForm">

            <!-- TYPE (HIDDEN) -->
            <input type="hidden" name="type" value="<%= section ? section.type : 'functions' %>">

            <!-- LABEL + TITLE (ONE LINE) -->
            <div class="row mb-3">
              <div class="col-md-6">
                <label class="form-label fw-semibold">Section Label<span class="text-danger">*</span></label>
                <input type="text" class="form-control" name="label" value="<%= section ? section.label : '' %>"
                  placeholder="Home Page â€“ Custom Section" required>
              </div>
              <div class="col-md-6">
                <label class="form-label fw-semibold">Title<span class="text-danger">*</span></label>
                <input type="text" class="form-control" name="title" value="<%= section ? section.title : '' %>"
                  placeholder="Custom Subscriptions for Every Requirement" required>
              </div>
            </div>

            <!-- SHORT DESCRIPTION -->
            <div class="mb-4">
              <label class="form-label fw-semibold">Short Description<span class="text-danger">*</span></label>
              <textarea class="form-control" name="shortDescription" rows="3"
                placeholder="Write short description here..."
                required><%= section ? section.shortDescription : '' %></textarea>
            </div>

            <!-- BUTTON -->
            <button type="submit" class="btn btn-primary px-4">
              Update Section
            </button>

          </form>

        </div>
      </div>
        <!-- Table -->
        <div class="datatables">
            <div class="card">
                <div class="card-body">
                    <div class="table-responsive">
                        <table id="growTool_config" class="table table-striped table-bordered text-nowrap align-middle">
                            <thead>
                                <tr>
                                    <th>Title</th>
                                    <th>Description</th>
                                    <th>Image</th>
                                    <th class="action-col">Action</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Modal -->
            <div class="modal fade" id="growToolModal" tabindex="-1" aria-hidden="true">
                <div class="modal-dialog modal-lg modal-dialog-centered">
                    <div class="modal-content border-0 shadow-lg rounded-3">
                        <div class="modal-header bg-light-subtle">
                            <h5 class="modal-title fw-semibold" id="growToolModalLabel">Add Features</h5>
                            <button type="button" class="btn-close btn-close-dark" data-bs-dismiss="modal"></button>
                        </div>
                        <div class="modal-body p-4">
                            <!-- Important: enctype for file upload -->
                            <form id="growToolForm" enctype="multipart/form-data">
                                <input type="hidden" id="growToolId">

                                <div class="mb-3">
                                    <label class="form-label fw-medium">Title <span class="text-danger">*</span></label>
                                    <input type="text" id="growToolTitle" class="form-control" placeholder="Enter title" required>
                                </div>

                                <div class="d-flex justify-content-between align-items-center mb-2">
  <label class="form-label fw-semibold">
    Description<span class="text-danger">*</span>
  </label>
  <button type="button"
          id="generateGrowToolAI"
          class="btn btn-sm btn-outline-primary">
    <i class="fa-solid fa-wand-magic-sparkles me-1"></i>
    Generate by AI
  </button>
</div>
                                <div class="mb-3">
                                    <textarea id="growToolDescription" class="form-control" rows="4" placeholder="Enter description" required></textarea>
                                </div>

                                <div class="mb-3">
                                    <label class="form-label fw-medium">Image <span class="text-danger">*</span></label>
                                    <input type="file" id="growToolImage" name="image" class="form-control" accept="image/*">
                                    <small class="text-muted d-block mt-1">
                                        <i class="fa-solid fa-circle-info text-primary"></i>
                                        Recommended Formats: <strong>jpg, png, webp</strong>
                                    </small>
                                    <img id="previewImage" src="" class="img-thumbnail mt-2" style="width:100%; max-width:200px; display:none;">
                                </div>

                                <div class="modal-footer border-0 pt-0">
                                    <button type="button" class="btn btn-light" data-bs-dismiss="modal">Cancel</button>
                                    <button type="submit" class="btn btn-primary px-4">Save</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>

<%- include('includes/allscripts') %>
<script src="/js/view.js/growtool.js"></script>
    <script src="/js/view.js/pagesection.js"></script>